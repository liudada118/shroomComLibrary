graph TB
    subgraph ç”¨æˆ·å±‚["ğŸ–¥ï¸ ç”¨æˆ·å±‚"]
        Browser["Chrome/Edge æµè§ˆå™¨<br/>Web Serial API"]
    end

    subgraph å‰ç«¯åº”ç”¨["âš›ï¸ å‰ç«¯åº”ç”¨ (Vite + React 18)"]
        direction TB
        Router["React Router v6<br/>è·¯ç”±ç®¡ç†"]
        
        subgraph Pages["ğŸ“„ é¡µé¢å±‚"]
            Login["Login<br/>ç™»å½•é¡µ"]
            Dashboard["Dashboard<br/>ä»ªè¡¨ç›˜"]
            GripPage["GripAssessment<br/>æ¡åŠ›è¯„ä¼°"]
            SitStandPage["SitStandAssessment<br/>åç«™è¯„ä¼°"]
            StandingPage["StandingAssessment<br/>ç«™ç«‹è¯„ä¼°"]
            GaitPage["GaitAssessment<br/>æ­¥æ€è¯„ä¼°"]
            History["AssessmentHistory<br/>å†å²è®°å½•"]
            HistoryReport["HistoryReportView<br/>å†å²æŠ¥å‘ŠæŸ¥çœ‹"]
        end
        
        subgraph Components["ğŸ§© ç»„ä»¶å±‚"]
            direction LR
            subgraph UI["UI åŸºç¡€ç»„ä»¶"]
                Button & Card & Input & Select & Dialog & Toast & EChart
            end
            subgraph ThreeJS["Three.js 3D ç»„ä»¶"]
                HandModel["HandModel<br/>æ‰‹éƒ¨3Dæ¨¡å‹"]
                FootModel["FootModel<br/>è¶³éƒ¨3Dæ¨¡å‹"]
                InsoleModel["InsoleModel<br/>é‹å«3Dæ¨¡å‹"]
                HumanModel["HumanModel<br/>äººä½“3Dæ¨¡å‹"]
            end
            subgraph Report["æŠ¥å‘Šç»„ä»¶"]
                GripReport["GripReport<br/>æ¡åŠ›æŠ¥å‘Š"]
                StandingReport["StandingReport<br/>ç«™ç«‹æŠ¥å‘Š"]
                HandPressureMap["HandPressureMap<br/>æ‰‹éƒ¨çƒ­åŠ›å›¾"]
                InteractiveArchChart["InteractiveArchChart<br/>è¶³å¼“å›¾è¡¨"]
                InteractiveCOPChart["InteractiveCOPChart<br/>COPå›¾è¡¨"]
                ReportViewer["ReportViewer<br/>æŠ¥å‘ŠæŸ¥çœ‹å™¨"]
            end
            subgraph Layout["å¸ƒå±€ç»„ä»¶"]
                Header["Header<br/>é¡¶éƒ¨å¯¼èˆª"]
                DeviceConnector["DeviceConnector<br/>è®¾å¤‡è¿æ¥å™¨"]
                PatientInfoDialog["PatientInfoDialog<br/>æ‚£è€…ä¿¡æ¯"]
            end
        end
        
        subgraph StateManagement["ğŸ”„ çŠ¶æ€ç®¡ç†"]
            AssessmentCtx["AssessmentContext<br/>è¯„ä¼°å…¨å±€çŠ¶æ€"]
            ThemeCtx["ThemeContext<br/>ä¸»é¢˜ç®¡ç†"]
        end
        
        subgraph Hooks["ğŸª Hooks"]
            useDevice["useDevice<br/>è®¾å¤‡è¿æ¥/æ¨¡æ‹Ÿ"]
            usePressureScene["usePressureScene<br/>å‹åŠ›åœºæ™¯"]
            useWebSocket["useWebSocket<br/>WebSocketé€šä¿¡"]
        end
        
        subgraph Libs["ğŸ“š æ ¸å¿ƒåº“"]
            direction LR
            subgraph Serial["ä¸²å£é€šä¿¡"]
                SerialService["SerialService<br/>64Ã—64 è„šå«ä¸²å£<br/>æ³¢ç‰¹ç‡ 3,000,000"]
                GloveService["GloveSerialService<br/>16Ã—16 æ‰‹å¥—ä¸²å£<br/>æ³¢ç‰¹ç‡ 921,600"]
            end
            subgraph SDK["Footpad SDK"]
                FootpadSerial["FootpadSerialService<br/>è„šå«ä¸²å£æœåŠ¡"]
                FootpadScene["FootpadScene<br/>è„šå«3Dåœºæ™¯"]
                PressureShaders["pressureShaders<br/>å‹åŠ›ç€è‰²å™¨"]
            end
            subgraph ReportGen["æŠ¥å‘Šç”Ÿæˆå™¨"]
                GripGen["gripReportGenerator<br/>æ¡åŠ›æŠ¥å‘Š"]
                SitStandGen["sitstandReportGenerator<br/>åç«™æŠ¥å‘Š"]
                GaitGen["gaitReportGenerator<br/>æ­¥æ€æŠ¥å‘Š"]
            end
            subgraph Utils["å·¥å…·åº“"]
                GripMapping["gripDataMapping<br/>æ¡åŠ›æ•°æ®æ˜ å°„"]
                FootAnalysis["FootAnalysis<br/>è¶³éƒ¨åˆ†æ"]
                Heatmap["heatmap<br/>çƒ­åŠ›å›¾"]
                HistoryService["historyService<br/>å†å²è®°å½•"]
            end
        end
    end

    subgraph Backend["ğŸ–§ åç«¯æœåŠ¡ (Express + WebSocket)"]
        ExpressAPI["REST API<br/>ç«¯å£ 3001"]
        WSServer["WebSocket Server<br/>å®æ—¶æ•°æ®æ¨é€"]
        FileStorage["æ–‡ä»¶å­˜å‚¨<br/>data/history.json<br/>data/reports/"]
    end

    subgraph Hardware["ğŸ”Œ ç¡¬ä»¶è®¾å¤‡å±‚"]
        Glove["å‹åŠ›æ‰‹å¥—<br/>16Ã—16 ä¼ æ„Ÿå™¨çŸ©é˜µ<br/>å·¦/å³æ‰‹"]
        FootPad["è„šå«ä¼ æ„Ÿå™¨<br/>64Ã—64 ä¼ æ„Ÿå™¨çŸ©é˜µ<br/>4å—è„šå«"]
        IMU["IMU æƒ¯æ€§ä¼ æ„Ÿå™¨<br/>å››å…ƒæ•°/æ¬§æ‹‰è§’"]
    end

    Browser --> Router
    Router --> Pages
    Pages --> Components
    Pages --> Hooks
    Components --> Libs
    Hooks --> Libs
    StateManagement --> Pages
    
    Serial -->|"Web Serial API"| Hardware
    GloveService -->|"AA 55 03 99 å¸§åè®®"| Glove
    SerialService -->|"AA 55 03 99 å¸§åè®®"| FootPad
    
    useWebSocket --> WSServer
    ExpressAPI --> FileStorage
    
    classDef page fill:#e3f2fd,stroke:#1565c0,stroke-width:2px
    classDef component fill:#f3e5f5,stroke:#7b1fa2,stroke-width:1px
    classDef lib fill:#e8f5e9,stroke:#2e7d32,stroke-width:1px
    classDef hardware fill:#fff3e0,stroke:#e65100,stroke-width:2px
    classDef backend fill:#fce4ec,stroke:#c62828,stroke-width:2px
    
    class Login,Dashboard,GripPage,SitStandPage,StandingPage,GaitPage,History,HistoryReport page
    class Button,Card,Input,Select,Dialog,Toast,EChart,HandModel,FootModel,InsoleModel,HumanModel,GripReport,StandingReport,HandPressureMap,InteractiveArchChart,InteractiveCOPChart,ReportViewer,Header,DeviceConnector,PatientInfoDialog component
    class SerialService,GloveService,FootpadSerial,FootpadScene,PressureShaders,GripGen,SitStandGen,GaitGen,GripMapping,FootAnalysis,Heatmap,HistoryService lib
    class Glove,FootPad,IMU hardware
    class ExpressAPI,WSServer,FileStorage backend
